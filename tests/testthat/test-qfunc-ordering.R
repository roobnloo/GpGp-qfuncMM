test_that("Qfunc ordering", {
  locs <- matrix(
    c(
      21, 21, 10, 1, 0,
      21, 23, 10, 1, 0,
      21, 21, 10, 2, 0,
      21, 23, 10, 2, 0,
      21, 21, 10, 3, 0,
      21, 23, 10, 3, 0,
      15, 4, 11, 1, 1,
      16, 3, 11, 1, 1,
      15, 4, 11, 2, 1,
      16, 3, 11, 2, 1,
      15, 4, 11, 3, 1,
      16, 3, 11, 3, 1
    ),
    ncol = 5,
    byrow = TRUE
  )

  set.seed(1000)
  ord <- order_qfuncmm(locs)
  expect_equal(ord, c(3, 10, 4, 9, 6, 11, 5, 12, 2, 8, 1, 7))
})
